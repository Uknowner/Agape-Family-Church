<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sermon - Agape Family Church</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="sermon_style.css">
</head>
<body>

<header>
    <h1>Sermon Details</h1>
</header>

<main>
    <div id="single-sermon-content" class="sermon-container">
        <!-- Dynamic content will be loaded here -->
    </div>
</main>

<footer>
    <p>&copy; 2025 Agape Family Church. All rights reserved.</p>
    <a href="sermons.html"><i class="fas fa-arrow-left"></i> Back to Sermons</a>
</footer>

<<script>
  // Get the sermon ID from the URL
  const params = new URLSearchParams(window.location.search);
  const sermonId = params.get('id');

  console.log('Looking for sermon ID:', sermonId);

  // Fetch sermons.json and display the correct sermon
  fetch('sermons.json')
    .then(res => {
      if (!res.ok) throw new Error('Failed to fetch sermons.json');
      return res.json();
    })
    .then(sermons => {
      console.log('Loaded sermons:', sermons);
      
      // Find sermon by date ID
      const sermon = sermons.find(s => s.id === sermonId);
      console.log('Found sermon:', sermon);
      
      const container = document.getElementById('single-sermon-content');

      if (sermon) {
        container.innerHTML = `
          <h2>${sermon.title}</h2>
          <div class="sermon-meta">
            ${sermon.date ? `<div><i class="fas fa-calendar-alt"></i> ${new Date(sermon.date).toLocaleDateString()}</div>` : ''}
            ${sermon.speaker ? `<div><i class="fas fa-user"></i> ${sermon.speaker}</div>` : ''}
            ${sermon.duration ? `<div><i class="fas fa-clock"></i> ${sermon.duration}</div>` : ''}
          </div>

          ${sermon.scripture ? `<p><strong>Key Scriptures:</strong> ${sermon.scripture}</p>` : ''}
          <br>
          ${sermon.content ? `<p><span style="white-space: pre-line;">${sermon.content}</span></p>` : ''}
        `;
          
          <!-- Video Section - Only shows if video exists and is not "None" -->
          ${sermon.video && sermon.video !== "None" ? `
            <div class="media-section">
              <h3><i class="fas fa-video"></i> Video</h3>
              <div class="video-container">
                <iframe src="${sermon.video}" frameborder="0" allowfullscreen></iframe>
              </div>
            </div>
          ` : ''}
          
          <!-- Audio Section - Only shows if audio exists and is not "None" -->
          ${sermon.audio && sermon.audio !== "None" ? `
            <div class="media-section">
              <h3><i class="fas fa-volume-up"></i> Audio</h3>
              <div class="audio-container">
                <audio controls style="width: 100%;">
                  <source src="${sermon.audio}" type="audio/mpeg">
                  Your browser does not support the audio element.
                </audio>
              </div>
            </div>
          ` : ''}
      } else {
        container.innerHTML = `<p>Sermon not found. Available sermons: ${sermons.map(s => s.id).join(', ')}</p>`;
      }
    })
    .catch(err => {
      console.error('Error loading sermons:', err);
      document.getElementById('single-sermon-content').innerHTML = `<p>Error loading sermon: ${err.message}</p>`;
    });
</script>

</body>
</html>